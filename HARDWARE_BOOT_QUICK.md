# 硬件启动模式配置 - 快速章

## 你的情况

```
问题: 程序烧进 Flash 了，但 Reset 后不启动
原因: BOOT0 引脚在复位时被采样为 HIGH (1)
结果: 芯片启动 ROM Bootloader 而不是你的程序
```

---

## 启动模式对照表 ⚡

| 状态 | BOOT0 | 启动方式 | 地址 | 你的情况 |
|------|-------|---------|------|---------|
| ✅ 正常 | **0** | Flash | 0x08000000 | 需要改为这个 |
| ❌ 当前 | **1** | Bootloader | 0x1ffff000 | 现在在这里 |
| 📚 调试 | 1 | SRAM | 0x20000000 | 不用 |

---

## 解决方案

### 方案 A: 硬件修复 ✅ 推荐 (15分钟, 永久)

#### 1. 找到 BOOT0 引脚

```
在你的开发板上找:
  ☐ GD32F303RCT6 芯片 (LQFP100 package)
  ☐ Pin 60 = BOOT0 (可能标记在焊盘或排针)
  ☐ 通常离芯片较近的位置

如果看不到:
  👉 查看电路原理图 PDF
  👉 原理图会标记 BOOT0 的走线
```

#### 2. 检查当前连接

```
BOOT0 目前连接到?

❌ 3.3V? → 这是问题! 需要改
☑️  GND? → 好的，但可能有干扰
❓ 悬空或不确定? → 需要接地
```

#### 3. 修复连接 - 选择一个方法

**方法1️⃣: 最简单 - 直连到GND**
```
准备:
  • 细导线 (24 AWG / 0.5mm²)
  • 烙铁 + 焊锡

步骤:
  1. 板子断电
  2. 焊一根线从 BOOT0 到 GND
  3. 检查焊点质量 (光滑不冷焊)
  4. 通电测试

结果: ✅ BOOT0 永久连到 0V
用时: 5分钟
```

**方法2️⃣: 专业 - 焊10k电阻到GND**
```
准备:
  • 10kΩ 0805/1206 贴片电阻 或 插件电阻
  • 烙铁 + 焊锡

步骤:
  1. 找 BOOT0 焊盘
  2. 找最近的 GND 焊盘
  3. 焊接: BOOT0 ——[10k]—— GND
  4. 通电测试

结果: ✅ BOOT0 被10k电阻始终拉低 (更稳定)
用时: 10分钟
特点: 最符合原厂应用笔记
```

**方法3️⃣: 如果有跳帽**
```
你的板子如果有跳墩写着:
  [BOOT0] [GND]  或  [GND] [3.3V]

改法:
  - 把跳帽从 3.3V 侧移到 GND 侧

或:
  - 直接去掉跳帽 (悬空会被下拉)

用时: 1分钟
```

#### 4. 验证修复

```
用万用表验证 (板子断电状态):

设置: 直流电压档
黑表笔: GND
红表笔: BOOT0
读数: 应该近似 0V

✓ 0.0V     → 完美!
✗ 3.3V     → 还没改好
⚠️ 1-2V     → 有高阻抗, 可能不稳定
```

#### 5. 测试

```
重新通电后:

□ 按 Reset 按钮
□ 观察:
  ✓ LED 是否闪烁?
  ✓ 串口是否有输出?

□ 诊断:
  bash fix_boot0.sh check
  显示应该是: pc = 0x08007xxx (Flash)

✅ 如果都成功，问题解决!
```

---

### 方案 B: 软件临时修复 (如无法改硬件)

```bash
# 每次都连调试器，手动启动程序
bash fix_boot0.sh force

# 缺点: 需要调试器，断开后程序停止
# 优点: 不需要改硬件
```

---

## 硬件位置参考图

```
你的 GD32 开发板

                    ┌────────────────┐
                    │   GD32F303RCT6 │
                    │   LQFP100      │
                    │                │
    P▲ BOOT0 ←──────┤ Pin 60         │
    i│              │                │
    ↓ GND  ←────────┤ Pin 61         │
      (黑色)        │                │
                    └────────────────┘
                           ▲
                           │
                    焊点就在这附近
```

---

## 快速参考

| 需求 | 命令 | 用途 |
|------|------|------|
| 检查当前启动模式 | `bash fix_boot0.sh check` | 看 PC 是否在 Flash |
| 临时强制启动 | `bash fix_boot0.sh force` | 调试用 |
| 查看配置工具菜单 | `bash check_hardware_boot.sh` | 交互式菜单 |
| 启动模式对照 | `bash check_hardware_boot.sh 2` | 看表格 |
| BOOT0位置 | `bash check_hardware_boot.sh 3` | 定位引脚 |
| 修复方案 | `bash check_hardware_boot.sh 4` | 详细步骤 |
| 分步指南 | `bash check_hardware_boot.sh 5` | 逐步操作 |

---

## 所需工具

```
✓ 数字万用表       (验证电压)
✓ 烙铁 25-40W      (焊接)
✓ 焊锡 + 松香      (焊接材料)
✓ 细导线           (连线)

可选:
  ✓ 吸锡枪          (清理焊点)
  ✓ 显微镜/放大镜   (检查质量)
  ✓ 10k 电阻        (更专业)
```

---

## 成功标志

修复完成后:

```
✅ 按 Reset = 程序自动启动 (不需要调试器)
✅ LED 闪烁
✅ 串口每秒输出 "hello gd32f30x!"
✅ 诊断显示 pc = 0x08007xxx (Flash)
✅ 无需连接 JLink 程序就能运行
```

---

## 常见问题

**Q: 我找不到 BOOT0 焊盘**
```
A:
  1. 查看原理图 → 搜索 "BOOT0"
  2. 查看芯片手册 → GD32F303RCT6 Pin 60
  3. 如果是分板，询问厂商
```

**Q: 焊坏了，怎么办?**
```
A:
  1. 用热风枪加热
  2. 用吸锡枪清理
  3. 检查引脚是否损伤
  4. 重新焊接
```

**Q: 改好不工作怎么办?**
```
A: 检查:
  1. 万用表测 BOOT0 = 0V? ✓
  2. GND 接地良好? ✓
  3. 焊接是否虚焊? ✓
  4. 有焊渣短路? ✓
```

---

## 下一步

1. **立即**: 用指示灯和放大镜定位 BOOT0
2. **准备**: 准备焙铁、焊锡、万用表
3. **执行**: 按上述方法焊接
4. **验证**: 万用表测电压、观察 LED
5. **完成**: bash fix_boot0.sh check 诊断

---

**✨ 一旦修复完成，你的 GD32F303RCT6 就能真正独立工作了!** 没有调试器也能自动启动程序。

详细指南见: [`HARDWARE_BOOT_CONFIG.md`](HARDWARE_BOOT_CONFIG.md)
