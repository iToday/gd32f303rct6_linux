# 🔧 GD32F303RCT6 硬件启动模式配置

## 硬件启动模式基础

GD32F303RCT6 (兼容STM32F3系列) 使用两个引脚在复位时确定启动源：

### 启动模式对照表

| BOOT0 | BOOT1 | 启动来源 | 地址空间 | 用途 |
|-------|-------|---------|---------|------|
| **0** | X | **Flash** | 0x08000000 | ✅ 正常运行 |
| **1** | **0** | Bootloader/System ROM | 0x1ffff000 | ISP烧录/固件更新 |
| 1 | 1 | SRAM | 0x20000000 | 调试 |

**你的情况**: BOOT0=1，所以芯片启动Bootloader

---

## 物理位置 - 找到BOOT0引脚

### 在GD32F303RCT6芯片上

```
GD32F303RCT6 LQFP100 引脚分布:

        1 ——————————— 2      ┌──────────────────────┐
                              │  GD32F303RCT6        │
                  100———————99│ (LQFP100 package)    │
                              │                      │
           ┌─ BOOT0 是 Pin 60─┤ ★ (这个引脚很关键!) │
           │                  └──────────────────────┘
      GND ┴─ Pin 61 (通常)

注: 具体位置需查看:
  1. 芯片丝印 (通常标记为BOOT0)
  2. 电路图中的引脚定义
  3. 原理图PDF
```

### 在开发板上

根据你的板子类型，BOOT0可能有以下位置：

```
┌─ 选项 1: 焊盘设计 ────────────────────┐
│  开发板底部丝印标记 "BOOT0"             │
│  +3.3V  ◀─焊盘─▶  GND                 │
│         ▲                              │
│         └─ 可能有跳线或需要焊接        │
└────────────────────────────────────────┘

┌─ 选项 2: 排针设计 ────────────────────┐
│  ┌─ 靠近微控制器的排针                 │
│  │ [BOOT0] [GND]                       │
│  │                                     │
│  │ 可能还有: [BOOT1] [GND]            │
└────────────────────────────────────────┘

┌─ 选项 3: 跳帽设计 ────────────────────┐
│  两个焊盘上有可移动的小帽子             │
│  ┌──┐                                  │
│  │□│ ◀ 跳帽                           │
│  └──┘                                  │
│   ┏┓                                   │
│   ┃┃ [GND]  [3.3V]                    │
│   ┗┛                                   │
│   需要移到GND这一侧                    │
└────────────────────────────────────────┘
```

---

## 配置方案对比

### 方案 A: 直连到GND (最可靠) ✅

**最终效果**: BOOT0 = 0 (LOW) = Flash启动

#### 硬件连接图

```
GD32F303RCT6 引脚
Pin 60 (BOOT0)
    │
    ├─[R] (可选, 10k下拉电阻 STM32推荐但GD32不必须)
    │
    └─────── GND

或更直接：
    BOOT0 ──────┬──────── GND
                │
              GND
```

#### 实施方案

**选项 A1: 直接焊接** (永久解决)
```
硬件步骤:
1. 板子断电
2. 找到BOOT0焊盘或排针
3. 用导线焊接 BOOT0 → GND
   或用跳帽连接二者
4. 验证焊接无虚焊
5. 通电测试
```

**选项 A2: 焊接电阻** (更专业)
```
硬件步骤:
1. 板子断电
2. 在BOOT0到GND之间焊接:
   - 10kΩ 电阻 (标准做法)
   或
   - 0Ω 电阻/跳线
3. 不需要额外连接
4. 通电测试
```

**选项 A3: 使用跳帽** (如有现成跳墩)
```
焊盘布局可能如:
  J1: [·][·][·]
       │ │ │
      GND 3.3V

改法:
  把跳帽从 [中间-3.3V] 移到 [中间-GND]

或如果是两个独立焊盘:
  ┌─────────┐
  │BOOT0 GND│ 跳帽去掉或移到这里
  └─────────┘
```

---

### 方案 B: 悬空 (不推荐) ⚠️

**原理**: 让BOOT0浮空，可能被内部下拉拉LOW

**问题**: 不稳定，容易受干扰

```
建议: 不要这样做！太容易出问题
```

---

### 方案 C: 通过3.3V上拉到BOOT1 (高级)

**原理**: 如同时设置 BOOT0=1, BOOT1=1 则启动SRAM

**不推荐**: 太复杂，直接GND是最简单的

---

## 📋 分步指南

### Step 1: 物理检查（3分钟）

```
断电后打开板子，找到BOOT0:

□ 查看丝印标记 "BOOT0"
□ 查看电路原理图 PDF
□ 数清楚:
  - 从芯片数起: Pin 60就是BOOT0
  - 或在排针/焊盘上找标记

找不到? 方法:
  1. 电路原理图 → 查 BOOT0 连接
  2. 查看原厂 GD32F303 datasheet
  3. 看开发板用户手册 (如果有)
```

### Step 2: 识别当前连接状态（2分钟）

```
检查BOOT0目前连接到:

□ GND (Good! 但可能有外部干扰)
□ 3.3V (Bad! 需要改)
□ 中间引脚/悬空 (Risky! 可能不稳定)
□ 某个芯片引脚 (需查原理图)

危险警告:
  ❌ 千万不要短路到3.3V电源!
  ❌ 焊接时不要烫伤其他元件!
  ❌ 防止焊渣掉进IC!
```

### Step 3: 硬件改动（10分钟）

#### 如果BOOT0目前连到3.3V

**目标**: 断开3.3V连接，改为GND

```
方案1 - 你有尖嘴钳:
  1. 断电
  2. 用热风枪或烙铁加热焊点
  3. 用尖嘴钳轻轻拉断连接
  4. 清理焊渣
  5. 焊接到GND

方案2 - 你没有工具:
  1. 用美工刀轻轻刮断焊接线
  2. 或用烙铁熔断
  3. 确保没有残余焊锡短路

方案3 - 最安全(推荐):
  1. 用烙铁吸锡枪抽掉原来的焊点
  2. 清理干净
  3. 新焊一条线到GND
```

#### 如果BOOT0目前悬空或不确定

**目标**: 确保连接到GND

```
做法:
  1. 准备一根细导线 (24 AWG/0.5mm²)
  2. 焊接一头到 BOOT0
  3. 焊接另一头到 GND (最近的GND焊盘或排针)

验证:
  用万用表测试:
    - 黑表笔到 GND
    - 红表笔到 BOOT0
    - 显示 0Ω 或 < 1Ω = 连接成功
```

#### 如果你有焊接技巧 - 焊电阻方案

```
□ 准备 1x 10kΩ 0805/1206贴片电阻
  或 1x 10kΩ 插件电阻

□ 找 BOOT0 附近的GND焊盘

□ 焊接:
  BOOT0 ─[10k]─ GND

□ 优点:
  - 专业做法 (STM32应用笔记推荐)
  - 防止浮空干扰
  - 贴片电阻很小，不占空间

□ 验证:
  万用表测试 BOOT0 对 GND:
  正常应显示 ~10kΩ (浮空)
  或 0Ω (如果BOOT0焊盘连到GND)
```

### Step 4: 检查焊接质量（5分钟）

```
用显微镜或放大镜检查：

□ 焊点是否光亮、光滑？
□ 是否有冷焊点（灰白、暗沉）？
□ 是否有焊渣桥接到其他引脚？
□ 导线是否牢固？

如果有问题，重新焊接。
```

### Step 5: 电气验证（2分钟）

```
用万用表直流电压档：

1. 板子不通电
2. 黑表笔接 GND
3. 红表笔接 BOOT0
4. 读数应该是 0V (或非常接近)

结果理解：
  0.0V      ✅ 完美 (BOOT0已连GND)
  3.3V      ❌ 有问题 (可能还连3.3V)
  1-2V      ⚠️  有高阻抗 (可能效果不稳定)
```

### Step 6: 软件验证（1分钟）

```
断电重新通电后:

实时测试:
  □ 按Reset按钮
  □ 观察LED是否闪烁 (如main中有)
  □ 连接USB，看能否通过串口接收数据

如果成功:
  ✅ LED闪烁 = 程序在运行
  ✅ 串口有输出 = main()被执行
  ✅ 无需调试器程序自动启动 = 成功!

调试验证:
  bash fix_boot0.sh check
  # 应该显示: pc 0x08007xxx (Flash地址)
```

---

## 完整硬件连接示例

### 设计 1: 最简单 (直连GND)

```
原理图:
            GD32F303RCT6 LQFP100
            ┌──────────────────┐
            │                  │
       GND──┼─ Pin 61 (GND)    │
            │                  │
       ───┬─┼─ Pin 60 (BOOT0)  │
          │ │                  │
          └─┼─ GND             │
            │                  │
            └──────────────────┘

实物焊接:
  BOOT0 ┬─────── GND
        │        ↓
        ├─ 0Ω电阻 或 导线
        │
        └─ 焊点 A

GND ──┬─────── 多处GND焊盘 (选一个最近)
      ├─ 焊点 B (BOOT0来处)
      ├─ 焊点 C (其他电路)
      └─ 焊点 D (其他电路)
```

### 设计 2: 更专业 (带下拉电阻)

```
原理图:
       +3.3V
         │
         │
    ┌────┴────┐
    │   IC    │
    │         │
    │ BOOT0   │ Pin 60
    │    │    │
    │    ├─[R3 10k]──┬─ GND
    │    │           │
    └────┴───────────┘
                │
              GND

特点:
  - R3 (10kΩ) 确保 BOOT0 强制拉低
  - 即使BOOT0引脚有弱高阻力也不怕
  - 符合ST/GD原厂应用笔记
  - 成本 < ¥0.01 (电阻极便宜)
```

---

## 故障排查

### 改好后仍不能启动

```
检查清单:

□ BOOT0物理连接确实到了GND吗?
  方法: 万用表测BOOT0对GND应该是<1Ω

□ GND连接是否良好?
  方法: 测试 GND 对 GND, 应该 <0.1Ω

□ 是否有焊渣造成短路?
  方法: 显微镜检查焊点附近

□ 复位电路是否正常?
  方法: 用示波器观察 NRST 引脚的复位脉冲

□ BOOT0是否真的被采样到了?
  方法: 调试时读取 RCU 寄存器检查 BOOT 标志

如果都检查过仍有问题:
  - 可能是开发板设计问题
  - 需要查看原理图和datasheet
  - 或考虑用修改Option Byte的方法
```

### 长期稳定性考虑

```
如果用直连:
  BOOT0 ─── GND

可能遇到:
  ✅ 工作温度: -40°C ~ +105°C 都稳定
  ✅ 干扰: 一般不受电磁干扰影响

建议改进:
  BOOT0 ─[10k电阻]─ GND  ← 最佳实践

好处:
  ✓ 防止悬空时的浮动
  ✓ 限制泄漏电流
  ✓ 符合设计规范
```

---

## 总结

| 所需时间 | 难度 | 方案 | 永久性 | 效果 |
|---------|------|------|--------|------|
| 15分钟 | ⭐ | GND直连 | ✅ 永久 | ⭐⭐⭐⭐⭐ |
| 20分钟 | ⭐⭐ | 加10k电阻 | ✅ 永久 | ⭐⭐⭐⭐⭐ |
| 2分钟  | ⭐⭐⭐ | 用Option Byte编程 | ✅ 永久 | ⭐⭐⭐⭐ |
| 每次都要 | ⭐ | 调试器强制启动 | ❌ 临时 | ⭐⭐ |

**推荐**: BOOT0直连GND 或 加10k下拉电阻

---

## 常见问题 FAQ

**Q: 我找不到BOOT0怎么办?**
A:
  1. 查看电路原理图PDF (应该标记了)
  2. GD32F303RCT6数据手册 Pin 60
  3. 开发板用户手册

**Q: 万一焊错了怎么办?**
A:
  1. 烙铁加热融解焊点
  2. 用吸锡枪清理
  3. 重新焊接
  4. 最坏情况: 更换GD32芯片 (但通常能修)

**Q: 能不能都连到BOOT0?**
A:
  不推荐。BOOT0作为输入端，带过多负载会:
  - 消耗功率
  - 影响采样
  - 干扰其他功能

**Q: 通电后多久采样BOOT0?**
A:
  复位信号释放后立即采样 (microseconds级)
  所以必须在通电时就确保BOOT0为LOW

**Q: 能不能外接BOOT0按钮进入ISP模式?**
A:
  可以! 这时:
  - 按BOOT0按钮
  - 再按Reset
  - 进入 Bootloader ISP 模式

设计方法:
```
Ushaping:
        +3.3V
          │
          │
      [Button]
          │
          ├─[10k电阻]─ GND (下拉)
          │
    BOOT0 ─┴─
```

---

## 最后清单

完成以下步骤后，你的开发板应该能正常启动:

- [ ] 物理定位BOOT0引脚 (查原理图+标记)
- [ ] 确认当前BOOT0的连接状态
- [ ] 如果连到3.3V，断开并改为连GND
- [ ] 焊接质量检查 (显微镜)
- [ ] 电压验证 (万用表 BOOT0 对 GND = 0V)
- [ ] 上电测试 (Reset后程序自动运行)
- [ ] 验证 (LED闪/串口输出/软件诊断)

✅ 完成后，程序可以独立启动，不需要调试器!
